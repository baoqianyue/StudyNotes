## 二维观察    

### 坐标系统   

* 建模坐标系   
    
    一个局部坐标系，将基本图形与某些角点、中心点联系起来，比如在绘制圆形时，将圆心作为参考点，实质上是建立了一个以圆心为原点的建模坐标系   

* 世界坐标系    

    使用建模坐标系对每个基本对象进行了建模之后，需要将他们组合起来，为了确定他们之间的相对位置，就必须抛弃他们原有的坐标系，将其纳入一个统一的坐标系，就是世界坐标系(全局)    

* 观察坐标系   

    当二维场景确定后，就可以设置视点(照相机)的位置和方向，这就需要使用观察坐标系    

* 规范化设备坐标系     

    为了使观察处理独立于设备，将对象描述转换到一个中间坐标系，这个坐标系的坐标范围为[0,1]   

* 设备坐标系(DC)     

    DC用于定义图像空间，主要用于某一特殊的计算机图形显示设备表面的像素点定义     

### 坐标系之间的变换    

* 建模变换(Modeling Transformation)     

    将多个对象从各自的建模坐标系集合到世界坐标系上    

* 观察变换(Viewing Transformation)    

    VT是从世界坐标系到观察坐标系的变换，也叫视点变换，**观察坐标系的原点模拟视点或摄像机的位置**        

* 视口变换(Windows to Viewport Transformation)     

    屏幕不可能看到全部部分，所以要在观察坐标系下给定一个窗口对显示对象进行裁剪         

    视口变换是在**规范化空间给定一个窗口**，在**显示设备**给定一个视区，实现二维图形对象由窗口到视区的变换     
    就是根据给定的参数，找到窗口和视区的坐标映射关系      

    但是要注意设备坐标系的y轴方向往往和观察坐标的Y轴方向相反         

### 裁剪     

裁剪就是给定一个窗口，确定当前图形那部分在窗口内，哪些部分在窗口外，只显示在窗口内的那部分，这个过程叫裁剪     

* 点的裁剪    

    就是判断坐标在是否在窗口的坐标范围内      

* 直线裁剪    

    * Cohen-Sutherland编码算法     

        快速判断线段的完全可见和显然不可见    
        此算法适用于矩形窗口，对于其他形状的窗口未必有效     

    * 中点分割裁剪算法      

        ![middle clip](./img/middle.png)      

        从P0点出发找离P0最近的可见点A，从P1点出发找离P1最近的可见点B     

        效率较高     

    * Liang-Barsky参数化算法(梁友栋先生发明)       

        使用直线的参数方程和不等式组来描述线段和裁剪窗口的交集，求解出来的交集将被用于获知线的哪些部分应当绘制在屏幕上     

        


            

### GL投影模式    

在选择OpenGL裁剪窗口和视口之前，必须建立合适的模式来构建从世界坐标系到屏幕坐标系变换的矩阵，在OpenGL中，不能建立独立的二维观察坐标系，必须将裁剪窗口的参数作为投影变换的一部分来设置，所以最先设置的应该是投影模式。     

这里定义裁剪窗口和视口的函数将用于投影矩阵   

`glMatrixMode(GL_PROJECTION);`


### GL裁剪窗口函数    

定义一个二维裁剪窗口    

`gluOrtho2D(xwmin, xwmax, ywmin, ywmax);`  

该函数给出了将场景映射到屏幕的正交投影，由于二维场景要交给完整的三维OpenGL观察流水线处理，所以必须指定正交投影   

OpenGL裁剪函数使用-1到1的规范化坐标范围   

如果没有为程序指定裁剪窗口范围，就是用默认坐标(-1.0, -1.0)和(1.0, 1.0)，默认的裁剪窗口是以坐标原点为中心，边长为2的规范化正方形     

