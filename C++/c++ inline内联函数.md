# 内联函数    

## 函数调用机制    
函数调用是有时间和空间开销的，程序在执行一个函数之前需要做一些准备工作，要将实参、局部变量、返回地址以及若干寄存器都压入栈中，然后才能执行函数体内的代码，函数体中的代码执行完毕后还要清理堆栈，将之前都压入栈中的数据都出栈，才能执行函数调用位置之后的代码。    

## inline    
如果函数体内代码很多，需要执行很长时间，那么函数调用机制占用的时间可以忽略，如果函数体只有一两句代码，那么大部分时间都会花费在函数调用机制上，这种时间开销就不能忽略了。    

为了消除函数调用机制的大量时空开销，c++提供一种高效率的方法，即在编译器将函数调用处用函数体替换，类似于c语言的宏定义展开，这种在函数调用处直接嵌入函数体的函数称为内联函数(inline function)     

指定内联函数的方式很简单，只需在函数定义处加上inline关键字即可。    

看一个例子:    

```c++
#include <iostream>    

using namespace std;

inline void swap(int *a, int *b)
{
    int temp;
    temp = *a;
    *a = *b;
    *b = temp;
}

int main()
{
    int m,n;
    cin >> m >> n;
    cout << m << n << endl;
    swap(&m,&n);
    cout << m << n << endl;
    return 0;
}   
```     

注意，在函数声明处加上inline关键字是无效的，会被编译器自动忽略，需要在函数定义处加上inline。     

现在当程序执行到`swap(&m,&n);`处就会被置换成函数体。       

当函数比较复杂时，函数调用的时空开销可以忽略，大部分的cpu时间都会花费在执行函数体代码上，所以我们一般是将短小的函数声明为内联函数。     



## 缺点    

如果大量使用内联函数的话，编译后的程序会存在多份相同的函数拷贝，如果被声明为内联函数的函数体相当大，那么编译后的程序体积也会非常大。    

